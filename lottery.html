<!DOCTYPE html>
<html>
<head>
<title>ðŸŽ° THADE WORKSHOP LOTTERY ðŸŽ°</title>

<style>
body{
  margin:0;
  font-family:Arial, sans-serif;
  background:radial-gradient(circle,#3a004d,#000);
  color:white;
  text-align:center;
  overflow:hidden;
}

h1{
  margin-top:30px;
  font-size:38px;
}

.slot-container{
  display:flex;
  justify-content:center;
  gap:40px;
  margin-top:120px;
}

.slot{
  width:170px;
  height:170px;
  background:rgba(255,255,255,0.08);
  border-radius:20px;
  display:flex;
  align-items:center;
  justify-content:center;
}

.slot img{
  width:140px;
}

#attempt{
  margin-top:40px;
  font-size:18px;
  opacity:0.8;
}

button{
  padding:12px 30px;
  font-size:18px;
  border:none;
  border-radius:12px;
  margin-top:20px;
  cursor:pointer;
}

.active{
  background:#ff4d6d;
  color:white;
}

.inactive{
  background:#552233;
  color:#aaa;
  cursor:not-allowed;
}

#message{
  margin-top:20px;
  font-size:20px;
  min-height:60px;
  white-space:pre-line;
}

#bonusBox{
  position:absolute;
  top:15%;
  left:50%;
  transform:translateX(-50%);
  background:rgba(0,0,0,0.85);
  padding:30px 40px;
  border-radius:20px;
  border:2px solid #ff4d6d;
  width:60%;
  display:none;
  font-size:22px;
  line-height:1.6;
  white-space:pre-line;
}

#revealBtn{
  margin-top:20px;
  display:none;
  background:#ff4d6d;
  color:white;
}

#closeBtn{
  position:absolute;
  top:20px;
  right:30px;
  background:none;
  border:none;
  font-size:28px;
  color:white;
  cursor:pointer;
}
</style>
</head>
<body>

<button id="closeBtn">Ã—</button>

<h1>Lucky Love Lottery ðŸŽ°</h1>

<div id="bonusBox"></div>

<div class="slot-container">
  <div class="slot"><img id="slot1"></div>
  <div class="slot"><img id="slot2"></div>
  <div class="slot"><img id="slot3"></div>
</div>

<div id="attempt">Attempt 1 / 3</div>

<button id="stopBtn" class="inactive" disabled>Stop</button>

<div id="message"></div>

<button id="revealBtn">Reveal Your Gift ðŸ’„</button>

<!-- AUDIO -->
<audio id="romanticSound" src="romantic.wav" loop></audio>
<audio id="spinSound" src="spin.wav" loop></audio>
<audio id="stopSound" src="stop.wav"></audio>
<audio id="winSound" src="win.wav"></audio>

<script>

document.getElementById("closeBtn").onclick = function(){
  if(window.parent && window.parent.closeGame){
    window.parent.closeGame();
  } else {
    window.history.back();
  }
};

document.getElementById("revealBtn").onclick = function(){
  window.open("https://eGft.in/p~eHfO0iGRXWSCq","_blank");
};

const symbols = [
"heart.png",
"spade.png",
"diamond.png",
"star.png",
"ring.png",
"crown.png"
];

const scriptedResults = {
1:["spade.png","ring.png","diamond.png"],
2:["ring.png","star.png","crown.png"],
3:["heart.png","ring.png","star.png"],
bonus:["heart.png","heart.png","heart.png"]
};

let attempt = 1;
let spinning = false;
let spinInterval;
let state = "normal";
let romanticStarted = false;

const slot1 = document.getElementById("slot1");
const slot2 = document.getElementById("slot2");
const slot3 = document.getElementById("slot3");
const stopBtn = document.getElementById("stopBtn");
const bonusBox = document.getElementById("bonusBox");
const revealBtn = document.getElementById("revealBtn");

const romanticSound = document.getElementById("romanticSound");
const spinSound = document.getElementById("spinSound");
const stopSound = document.getElementById("stopSound");
const winSound = document.getElementById("winSound");

romanticSound.volume = 0.15;

function randomSymbol(){
  return symbols[Math.floor(Math.random()*symbols.length)];
}

function startSpinning(){
  spinning = true;

  spinSound.currentTime = 0;
  spinSound.play();

  spinInterval = setInterval(()=>{
    slot1.src = randomSymbol();
    slot2.src = randomSymbol();
    slot3.src = randomSymbol();
  },100);
}

function stopSpinning(){
  clearInterval(spinInterval);
  spinning = false;
  spinSound.pause();
  spinSound.currentTime = 0;
}

function activateButton(){
  stopBtn.disabled = false;
  stopBtn.className="active";

  if(!romanticStarted){
    romanticSound.play();
    romanticStarted = true;
  }
}

function deactivateButton(){
  stopBtn.disabled = true;
  stopBtn.className="inactive";
}

function nextAttemptFlow(){
  attempt++;

  if(attempt<=3){
    document.getElementById("attempt").innerText="Attempt "+attempt+" / 3";

    setTimeout(()=>{
      startSpinning();
      setTimeout(()=>activateButton(),2000);
    },2000);
  }
  else{
    showBonusFlow();
  }
}

function showBonusFlow(){

  bonusBox.style.display="block";
  bonusBox.innerText="Attempts over. Please try again tomorrow.";

  setTimeout(()=>{
    bonusBox.innerText=
    "But you have been such a nice, caring and loving girlfriend...\nYou deserve all the love and happiness";
  },12000);

  setTimeout(()=>{
    bonusBox.innerText="Here is a bonus attempt";
  },19000);

  setTimeout(()=>{
    bonusBox.style.display="none";
    document.getElementById("attempt").innerText="Attempt: Love / Everything";
    state="bonus";
    startSpinning();
    setTimeout(()=>activateButton(),2000);
  },24000);
}

stopBtn.onclick=function(){

  if(!spinning) return;

  deactivateButton();
  stopSpinning();

  stopSound.currentTime = 0;
  stopSound.play();

  if(state==="bonus"){
    slot1.src=scriptedResults.bonus[0];
    slot2.src=scriptedResults.bonus[1];
    slot3.src=scriptedResults.bonus[2];

    winSound.currentTime = 0;
    winSound.play();

    document.getElementById("message").innerText=
    "Winner ðŸ’– You won the lottery.\nThe prize is your loving and caring boyfriend for lifetime.";

    setTimeout(()=>{
      revealBtn.style.display="inline-block";
    },5000);

    return;
  }

  slot1.src=scriptedResults[attempt][0];
  slot2.src=scriptedResults[attempt][1];
  slot3.src=scriptedResults[attempt][2];

  nextAttemptFlow();
};

/* START */
startSpinning();      // spin immediately
activateButton();     // button activates after load
setTimeout(()=>activateButton(),2000);

</script>
</body>
</html>
